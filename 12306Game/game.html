<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html ng-app="build">
  <head>
    <base>
    
    <title>购票秘籍:春运反击战之击败12306多达99%的验证码</title>
    <meta charset="utf-8">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
<!--	<meta http-equiv="expires" content="0">    -->
	<meta http-equiv="keywords" content="12306,买票，回家">
	<meta http-equiv="description" content="This is my page">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<!--	<link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css">-->
<style type="text/css">
#exp{
		-webkit-perspective:800;
		-webkit-perspective-origin:50% 50%;
		-webkit-transform-style:-webkit-preserve-3d;
	}
#block6{
		-webkit-animation: rotatefrm 4s  linear infinite alternate;
	-moz-animation: rotatefrm 4s  linear infinite alternate;
	-ms-animation: rotatefrm 4s  linear infinite alternate;
	animation: rotatefrm 4s  linear infinite alternate;
	}
@-webkit-keyframes  rotatefrm{
				0%{
					-webkit-transform:rotateX(0deg);
					-ms-transform:rotateX(0deg);
					-moz-transform:rotateX(0deg);
<!--					transform:rotateX(0deg);-->
				}
				
				100%{
					-webkit-transform:rotateX(359deg);
					-ms-transform:rotateX(359deg);
					-moz-transform:rotateX(359deg);
					transform:rotateX(359deg);
				}
			}
</style>
  </head>
<div id='wx_pic' style='margin:0 auto;display:none;'>
<img src='images/biu.png' />
</div>
  
  <body ng-controller="myCtrl" style="background: rgb(255, 118, 118);">
  	<nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="#">12306验证码大考验</a>
          </div>
          
        </div>
      </nav>
   <div style="text-align:center;">
   	<h5 style="color:yellow">请您打败12306验证码，从容抢到回家车票!!!</h5> 
   </div>
   <!-- 广告位 -->
   <div class="container">
   		<div class="row">
   			
   			<div id="imgArea" class="col-xs-12 col-md-12">
   				<a href="#" class="thumbnail">
   					<img id="canvas" alt="loading..." src="">
   					</a>
   			</div>
   			
   		</div>
   </div>
   <div class="container">
   	<div class="row">
   			<div class="col-xs-4 col-md-4">
   			<a id="show"  class="btn  btn-success" >快快开始吧</a>
   			</div>
   			<div class="col-xs-4 col-md-4" style="text-align: center;">
   				
   			</div>
   			<div class="col-xs-4 col-md-4">
   			<a id="next" onclick="next()" class="btn  btn-info" >下一张</a>
   			</div>
   	</div>
   </div>
  </br></br></br>
   
    <div id="exp" class="container" style="position: fixed;bottom: 5px;padding:0px;width: 100%;">
   	 <div style="color:rgb(222, 255, 15);font-weight:bold;">↓↓↓↓↓BIU智能家居馆↓↓↓↓↓新品发布~好礼相送</div>
   	<div class="row" id="block6">
   		<div class="col-xs-12 col-md-12">
   			<a href="http://hmf.alicdn.com/L1/764/1/66rcvr5n.html?from=singlemessage&isappinstalled=0#rootid~oXQ7gtzJCJT8lmx3p_Uaza61vifg_parentid~oXQ7gtzJCJT8lmx3p_Uaza61vifg" class="thumbnail">
   					<img alt="heheda" src="images/biuLogo.png?_=233223"  style="width:100%;height:50px;">
   			</a>
   		</div>
   	</div>
   </div>
   
   <div id="imgs">
		
   </div>
   <img class="cursor" onclick="hide(this)" src="images/gou.png" style="width:20px;position:absolute;display:none"></img>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/data.js?_=232323"></script>
    <script>
    	var images=0;
    	var index=0;
    	var allImage=13;
    	var showSize=10;
    	var allpic=getOrder(allImage);
    	console.log(allpic);
   		$(document).ready(function(){
			$("#canvas").click(function(event){
					//console.log(event);
					addImg(event.clientY,event.clientX);
				});
			$("#canvas").attr("src","images/"+allpic[index]+".jpg?_="+(Math.random()*10000));
   	   	});
	   	function addImg(x,y){
		   	if(images>=8)return;
		   	x-=10;
			y-=10;
			//if(!getClickArea(x,y))return;
	   		var tar=$(".cursor").clone().show();
	   		tar.removeClass("cursor");
	   		tar.addClass("spot");
	   		tar.css("top",x+"px");
	   		tar.css("left",y+"px");
	   		tar.css("border-radius","50% 50%");
			$("#imgs").append(tar);
			images++;
		}
		function getClickArea(x,y){
			var tar=$("#canvas");
			var loc=tar.offset();
			if((x+10)<loc.left||(y+10)<loc.top)
				return false;
			return true;
		}

		function clear(){
			$("#imgs").html("");
			images=0;
		}
		function hide(dom){
			images--;
			$(dom).remove();
		}
		function next(){
			if(index>=showSize)
			{
				alert("点击右上角即可分享！");return;
			}
			if(images<=0){
				alert("请选择图片");return;
			}
			var ret=rs();
			var flag=getAnswer(ret);
			$("#show").text(((index+1)+"/"+showSize)+(flag?"正确":"错误"));
			clear();
			index++;
			if(index>=showSize){
				$("#canvas").attr("src","images/home.jpg");
				$("#show").text("您战胜了"+(50+parseInt(Math.random()*50,10))+"%的网友！！");
				$("#next").text("分享一下");
				return;
			}
			//console.log("images/"+allpic[index]+".jpg");
			$("#canvas").attr("src","images/"+allpic[index]+".jpg");
		}

		function rs(){
			var imgs=$("#imgs").children();
			//console.log(imgs);
			var arr=new Array();
			$.each(imgs,function(dom){
				var loc=imgs.eq(dom).offset();
				var x=loc.left,y=loc.top-10;
				var tar=$("#canvas");
				var loc=tar.offset();
				var xr=((x+10)-loc.left)/($("#canvas").width()/4);
				xr=parseInt(xr,10);
				
				var yr=((y+10)-loc.top)/(($("#canvas").height())/2);
				yr=parseInt(yr,10);
				//alert(xr+"  "+yr);
				if(yr==0){
					arr.push(xr);
				}else{
					arr.push(xr+4);
				}
			});
			arr=arr.sort();
			return arr;
		}
		function getAnswer(arr){
			//var b=data[index].answer;
			var b=data[allpic[index]].answer;
			var e=arr.join("-");
			if(b==e||b=="*")
				return true;
			return false;
		}

		//返回一个数组，size大小
		function getOrder(size){
			var x=new Array();
			for(var i=0;i<size;i++){
				x.push(i);
			}
			var number=(100*Math.random(1));
			for(i=0;i<number;i++){
                var t1=Math.random()*allImage;
                var t2=Math.random()*allImage;
                t1=parseInt(t1,10);
                t2=parseInt(t2,10);
               // console.log(t1+"  "+t2);
                var tmp=x[t2];
                x[t2]=x[t1];
                x[t1]=tmp;
			}
			return x;
		}
		
    </script>
  </body>
</html>
